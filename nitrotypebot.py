from PIL import ImageGrab
from PIL import ImageOps
from numpy import *
import win32api,win32con
import numpy
import os
import time,string
#hashk = {}
#hashk = {'1300?9143?30?50?3140?309?3138?203?0?30?03?2137?02?1102?137?0?219?20?137?0?111?0?13702?111?02137?0?111?0?16?130?0?111?0?16?130?419?416?131?23130?30?90?90130?02313003?2001300?231300?121?1300?121?130?2121?1220': 'q', '1350?2113?2137?2113?21370?113?01370?15013702?1302137?2015137?40?0?802138?150137?4111?0137?0?112?0137?0?112?213702?3149?03?149?20?2149?51401': 'r', '1296?21520?1520?21510?14139013?3138015?2137?1402?150?20?151?02151?0?137?2112?0?137?2112?0?1370?111?41370?1513802?1002?3137017137?1502137?160152?0152?21173': 'u', '1354?8144?12141?15139?15138?17137?17137?419?4137?3111?3137?2113?2137?2113?2137?3111?3137?517?5137?17137?17138?407?4140?13142?111284': 'o', '1413?6141?214?302?3139?413?06?2137?202?12?20?50?137?0?312?0?60?1370?412?314?02137?215?2160?1370?15?215?0?1370?150?15?3137?3140?13?4138?0?50?9137?2012?3138?2014139?140151?20152?21281': 'a', '1236?6148?40214802?41480?31500?119?21310?119?21310?119?01310?2101310?20021310231310231310?2101310?118?201310?119?01310?119?21310?2118?21310?414902?4148?303148?61244': 'T', '1458?2152?2151?16136?30?011?3134?2017?213305?010?202?133?40?140?1370?112?201370?113?21370?113?2137?2113?21497': 't', '1505?2120?21300?120?01300?2118?201300?220130024130024130?230151?20152?0152?21497': 'l', '1242?2113?2137?2113?2137?2113?21370?1501370?15013702?1302137?30?1102137?160137?160137?4111?2137?0?112?2137?0?151?0?151?0?15137?0?15137?20?0?12137?1502138?150140?130152?2152?21173': 'n', '1236?2119?2131?2119?2131?2119?21310?2101310?21013102?19021310231310?90?1101310?90?1101310?180?19?01310?180?19?0131?217?0?19?0131?316?0?19?2131?414?517?3131?0?1215?4131?210?131?305?120?2132?91?306?3133?713?30?6135?514?9147?51177': 'B', '1242?2121?1300?121?1300?2119?21300?23130024130?3021130?130?10131?515?615?2130?419?416?130?0?111?0?16?130?0?111?0?13702?111?02137?0?111?0?137?0?317?30?137?202?100?2137?304?304?3138?309?3140?12146?51287': 'p', '1242?2152?21520?21510?141390?15138013?4137?140?2137?150?150?20?151?0?137?2112?0?137?2112?0?137?2111?41370?161370?1613702?1002?3137?1403137?160137?160152?2152?21173': 'u', '1296?2113?2137?2113?2137?3111?201370?319?301370?417?30213702?414?601370?20?41?701370?16137?1312?2137?21?302?413?2137?212?912?2137?171370?1501370?513?7013702?315?4031370?318?3021370?2110?30137?2112?20137?2113?21227': 'x', '1359?6141?214?8139?413?302?4137?512?202?0?4137?512?80?137?512?80?137?413?314?0?137?215?215?0?1370?15?215?3137?3140?13?5137?70?9137?70?40?4137?2012?3138?150139?140152?2152?21281': 'a', '1512?2113?2137?2113?2137?2113?2130?4130?150130?4130?150130?02?1302?1302130?413?1403130?413?160131?214?160152?2152?21443': 'i', '1313?6135?319?8132?713?31?06?131?205?21?120130?202?302?40?413?20130?0?70?402?15?2130?315?20?1?02?16?130?217?0130217?1300?17?0130217?130?315?3130217?130?0?70?1302?15?2130?02?50?213?0?15?0129?405?214?0?8129?0?40?414?02?50?129?0?12?416?304?3129?0?113?8130?3115?4133?1297': 'g', '1354?9143?13140?309?3138?203?02?20?02?2138?20?40?60?2137?0?2130?14?20?137?3140?15?0?1370?150?15?0?137?2150?15?02137?0?140?15?0?137?0?410?15?0?137?20?40?14?20?138?205?14?4138?403?14?3141?614?21391': 'e', '1296?2121?130?3120?1300?4118?1300?6115?213003?7112?21300?402?519?201300?502?616?4130?24130?214?602?10130?216?15141?12132?215?13134?212?131370?131400?1114202?71450?5148?3151?21242': 'y', '1460?514?5139?713?6137?40?412?6137?60?212?6137?70?213?4137?312?20?214?3137?214?20?15?0137?214?20?214?2137?512?02?21?4137?512?20?7137?512?30?20?3137?513?8139?414?7148?41338': 's', '11512': ' ', '1235?2120?2130?2120?21300?2118?201300?2201300?220130024130?230130?230137?5110?2137?3112?2137?0?112?2137?0?151?0?2150?0?15137?17137?30?13138?1402139?140141?120152?2152?21173': 'h', '1458?2113?21370?113?21370?113?0133?40?150131?3016?202130?3021130?4017?02130?70?150130?2150?113?01300?150?113?01300?2140?113?2130?413?2113?21443': 'f', '1566?2113?2137?2113?21370?113?0130?4130?150130?02?1302?1302130?02?13017130?413?1502130?413?160152?0152?2152?21389': 'i'}
#hashk = {'126?2113?2137?2113?21370?1501370?15013702?1302137?30?1102137?160137?160137?4111?2137?0?112?2137?0?151?0?2150?0?15137?17137?30?13138?20?1102138?150137?160137?4111?2137?0?112?2137?0?151?0?2150?0?15137?17137?302?12138?1402139?140142?110111': 'm', '1408?9143?13140?309?3138?202?60?03?2137?0?120?2137?0?219?20?137?3111?0?1370?112?021370?112?02137?3111?0?137?0?319?0?137?202?18?20?137?30?18?4138?418?31390': 'c', '1413?6141?214?302?3139?413?06?2137?202?12?20?50?137?0?312?0?60?1370?412?314?02137?215?2160?1370?15?215?0?1370?150?15?3137?3140?13?4138?0?50?9137?2012?3138?2014139?140151?20152?21281': 'a', '1260?1520?21510?514804?614407?61410?504?61380?1?605?31370?15?604137?218?50?145?9142?11140?11141?10144?20?414704?5145?305?4143?504?5143?504?4144?603?147?403137?217?81370?14?111370?1314002?814403?41470?31500?152?2126': 'w', '1354?9143?13140?309?3138?203?02?20?02?2138?20?40?60?2137?0?2130?14?20?137?3140?15?0?1370?150?15?0?137?2150?15?02137?0?140?15?0?137?0?410?15?0?137?20?40?14?20?138?205?14?4138?403?14?3141?614?21363?2113?2111': 'e', '1289?2120?2130?2120?21300?2118?201300?2201300?220130024130?230130?230143?514?2142?30?214?2137?212?40?412?2137?90?41400?100?41380?512?40?413702?314?50?21370?317?40?1370?219?5137?2112?3137?2113?21227': 'k', '1408?9143?13140?3010?2138?202?60?202?138?17137?0?219?20?137?3111?3137?2113?21370?113?0137?2113?2137?3111?3137?0?317?30?137?202?100?2138?2011?2140?307?3142?111284': 'o', '1236?6148?40214802?41480?31500?119?21310?119?21310?119?01310?2101310?20021310231310231310?2101310?118?201310?119?01310?119?21310?2118?21310?414902?4148?303148?61244': 'T', '1458?2152?2151?16136?30?011?3134?2017?213305?010?202?133?40?140?1370?112?201370?113?21370?113?2137?2113?21497': 't', '1242?2113?2137?2113?2137?2113?21370?1501370?15013702?1302137?30?1102137?160137?160137?4111?2137?0?112?2137?0?151?0?151?0?15137?0?15137?20?0?12137?1502138?150140?130152?2152?21173': 'n', '?46209?4303?20?402?420?40?60?400?50?70?450?70?380?60?70?450?702?380?50?70?390?50?70?400?40?70?4105?5103?452': 'r', '1296?2113?2137?2113?01370?113?01370?15013702?1302137017137?30?1102138?150137?4111?0137?0?112?2137?0?15102?151?0?151?0?15137?02?14137?2015138?1402140?130152?0152?2152?21119': 'n', '1242?2121?1300?121?1300?2119?21300?23130024130?3021130?130?10131?515?615?2130?419?416?130?0?111?0?16?130?0?111?0?13702?111?02137?0?111?0?137?0?317?30?137?202?100?2137?304?304?3138?309?3140?12146?51287': 'p', '1296?2113?2137?2113?2137?3111?201370?319?301370?417?30213702?414?601370?20?41?701370?16137?1312?2137?21?302?413?2137?212?912?2137?171370?1501370?513?7013702?315?4031370?318?3021370?2110?30137?2112?20137?2113?21227': 'x', '1359?6141?214?8139?413?302?4137?512?202?0?4137?512?80?137?512?80?137?413?314?0?137?215?215?0?1370?15?215?3137?3140?13?5137?70?9137?70?40?4137?2012?3138?150139?140152?2152?21281': 'a', '1235?2120?21300?120?01300?2118?201300?220130024130021?3130?200?3137?615?6137?419?4137?0?111?0?137?0?111?0?13702?111?02137?0?111?0?137?0?317?30?137?202?100?2137?304?304?3138?309?3140?12146?51287': 'b', '141?0152?21311?9143?13140?3010?2138?202?60?202?138?17137?0?219?20?137?3111?3137?2113?21370?113?0137?2113?2137?3111?3137?0?317?30?137?202?100?2138?2011?2140?307?3142?111284': 'o', '1350?2121?1300?2120?1300?4118?13003?5114?213006?4112?01300?304?419?201300?603?514?30?130?213?503?80?2130?216?404?30?4140?504?3142?10134?215?40?51370?12?50?51390?502?414204?514502?41480?31500?152?21188': 'y', '1300?9143?30?50?3140?309?3138?203?0?30?03?2137?02?1102?137?0?219?20?137?0?111?0?13702?111?02137?0?111?0?16?130?0?111?0?16?130?419?416?131?23130?30?90?90130?02313003?2001300?231300?121?1300?121?130?2121?1220': 'q', '1452?2119?2131?2119?21310?119?01310?21013102?19021310231310231310?2101310?2117?201310?119?0131?2119?21497': 'I', '1460?514?5139?713?6137?40?412?6137?60?212?6137?70?213?4137?312?20?214?3137?214?20?15?0137?214?20?214?2137?512?02?21?4137?512?20?7137?512?30?20?3137?513?8139?414?7148?41338': 's', '126?2113?2137?2113?01370?113?01370?15013702?1302137017137?302?1002138?150137?4111?0137?0?112?2137?0?15102?151?0?2150?0?15137?202?13137?3014138?20?0?902137?160137?4111?0137?0?112?2137?0?15102?151?0?2150?0?15137?203?12137?3014138?1402141?120111': 'm', '1458?2113?21370?113?21370?113?0133?40?150131?3016?202130?3021130?4017?02130?70?150130?2150?113?01300?150?113?01300?2140?113?2130?413?2113?21443': 'f', '1296?21520?1520?21510?14139013?3138015?2137?1402?150?20?151?02151?0?137?2112?0?137?2112?0?1370?111?41370?1513802?1002?3137017137?1502137?160152?0152?21173': 'u', '1512?2113?2137?2113?2137?2113?2130?4130?150130?4130?150130?02?1302?1302130?413?1403130?413?160131?214?160152?2152?21415?2113?2111': 'i', '1350?2113?2137?2113?21370?113?01370?15013702?1302137?2015137?40?0?802138?150137?4111?0137?0?112?0137?0?112?213702?3149?03?149?20?2149?51401': 'r', '1300?9143?30?50?3140?309?3138?203?0?30?03?2137?02?1102?137?0?219?20?137?0?111?0?13702?111?02137?0?111?0?130?215?0?111?0?1300?15?419?41300?2213102?80?13130024130?2202130?230152?0152?0152?21227': 'd', '1514?514?5139?30?313?02?3137?205?212?40?137?602?14?4137?312?20?214?3137?214?02?15?01370?14?20?214?0137?314?02?13?3137?512?02?21?4137?02?212?202?6137?513?204?3138?414?30?3148?41338': 's', '174?2119?2131?2119?21310?119?01310?21013102?19021310231310231310?90?1101310?2170?18?201310?180?19?0131?2180?19?21410?1520?1520?142?2180?19?2131?2180?19?21310?180?19?01310?90?11013102?80?100213102313102?19021310?2101310?119?0131?2119?2131?2119?21119': 'H', '1505?2120?21300?120?01300?2118?201300?220130024130024130?230151?20152?0152?21497': 'l', '1236?2119?2131?2119?2131?2119?21310?2101310?21013102?19021310231310?90?1101310?90?1101310?180?19?01310?180?19?0131?217?0?19?0131?316?0?19?2131?414?517?3131?0?1215?4131?210?131?305?120?2132?91?306?3133?713?30?6135?514?9147?51177': 'B', '1289?2120?21300?120?01300?2118?201300?220130024130024130?230137?519?20137?3112?2137?0?112?2137?0?15102?151?0?2150?0?15137?202?13138?2014138?1402141?120152?0152?21173': 'h', '1242?2152?21520?21510?141390?15138013?4137?140?2137?150?150?20?151?0?137?2112?0?137?2112?0?137?2111?41370?161370?1613702?1002?3137?1403137?160137?160152?2152?21173': 'u', '1354?8144?12141?15139?15138?17137?17137?419?4137?3111?3137?2113?2137?2113?2137?3111?3137?517?5137?17137?17138?407?4140?13142?111284': 'o', '1236?2119?2131?2119?2131X?119?X131X?21X131X2?19X2131X23131X23131X?12X?8X131X?111X?15?2X131X?111X?16?X131X?110?X?16?2131?2110?X?16?2131?318?2X?139?X?314?6139?2X?8X2?141?X10?2141?3X6?3143?10146?61294': 'P', '141?0152?21316?6141?214?302?3139?413?06?2137?202?12?20?50?137?0?312?0?60?1370?412?314?02137?215?2160?1370?15?215?0?1370?150?15?3137?3140?13?4138?0?50?9137?2012?3138?2014139?140151?20152?21281': 'a', '1512?2113?2137?2113?2137?2113?2130?4130?150130?4130?150130?02?1302?1302130?413?1403130?413?160131?214?160152?2152?21443': 'i', '1313?6135?319?8132?713?31?06?131?205?21?120130?202?302?40?413?20130?0?70?402?15?2130?315?20?1?02?16?130?217?0130217?1300?17?0130217?130?315?3130217?130?0?70?1302?15?2130?02?50?213?0?15?0129?405?214?0?8129?0?40?414?02?50?129?0?12?416?304?3129?0?113?8130?3115?4133?1297': 'g', '1354?9143?13140?309?3138?203?02?20?02?2138?20?40?60?2137?0?2130?14?20?137?3140?15?0?1370?150?15?0?137?2150?15?02137?0?140?15?0?137?0?410?15?0?137?20?40?14?20?138?205?14?4138?403?14?3141?614?21391': 'e', '1296?2121?130?3120?1300?4118?1300?6115?213003?7112?21300?402?519?201300?502?616?4130?24130?214?602?10130?216?15141?12132?215?13134?212?131370?131400?1114202?71450?5148?3151?21242': 'y', '1343?2120?21300?120?01300?2118?201300?220130024130024130?230144?413?20143?20?15?2142?202?313?2137?21?502?31410?803?31390?20?212?303?213803?214?303?213702?217?302?1370?219?30?1370?112?3137?2113?0152?21173': 'k', '11512': ' ', '1235?2120?2130?2120?21300?2118?201300?2201300?220130024130?230130?230137?5110?2137?3112?2137?0?112?2137?0?151?0?2150?0?15137?17137?30?13138?1402139?140141?120152?2152?21173': 'h', '1566?2113?2137?2113?21370?113?0130?4130?150130?02?1302?1302130?02?13017130?413?1502130?413?160152?0152?2152?21389': 'i'}
hashk = {'1505?2120?21300?120?01300?2118?201300?220130024130024130?230151?20152?0152?21497': 'l', '141?2152?21262?6141?214?8139?413?302?4137?512?202?0?4137?512?80?137?512?80?137?413?314?0?137?215?215?0?1370?15?215?3137?3140?13?5137?70?9137?70?40?4137?2012?3138?150139?140152?2152?21281': 'a', '1350?2113?2137?2113?01370?2111?021370?319?20213702?317?20313704?313?601370?202?31?701370?40?712?21370?1?302?314?2137?213?202?313?2137?212?50?312?01370?902?401370?612?30?3013703?215?20513702?217?3031370?2110?2021370?112?20137?2113?0152?21173': 'x', '1236?2119?2131?2119?2131?2119?21310?2101310?21013102?19021310231310?100?1001310?100?1001310?190?18?01310?190?316?2131?218?0?415?2131?317?02?5136?414?60?5134?0?1302?4133?20?140?5131?306?312?50?3132?1015?40?2133?817?40?135?4111?4151?31173': 'R', '141?2152?21262?6141?214?8139?413?302?4137?512?202?0?4137?512?80?137?512?80?137?413?314?0?137?215?215?0?1370?15?215?3137?3140?13?5137?70?9137?70?40?4137?2012?3138?150139?140152?2152?21253?2113?2111': 'a', '1408?9143?13140?309?3138?202?60?03?2137?0?120?2137?0?219?20?137?3111?0?1370?112?021370?112?02137?3111?0?137?0?319?0?137?202?18?20?137?30?18?4138?418?31390': 'c', '1349?13139?507?5135?3015?3133?202?20?70?202?2132?20?170?2131?0?3113?30?131?3117?31310?119?0131?2119?2131?3117?3131?0?3113?30?131?20?1602?2132?203?202?302?203?2134?3013?3136?605?6139?131340': '0', '1289?2120?2130?2120?21300?2118?201300?2201300?220130024130?230130?230143?514?2142?30?214?2137?212?40?412?2137?90?41400?100?41380?512?40?413702?314?50?21370?317?40?1370?219?5137?2112?3137?2113?21227': 'k', '1408?9143?13140?3010?2138?202?60?202?138?17137?0?219?20?137?3111?3137?2113?21370?113?0137?2113?2137?3111?3137?0?317?30?137?202?100?2138?2011?2140?307?3142?111284': 'o', '1350?2113?2137?2113?21370?113?01370?15013702?1302137?2015137?40?0?802138?150137?4111?0137?0?112?0137?0?112?213702?3149?03?149?20?2149?51373?2113?2111': 'r', '1290?2119?2131?2119?2131?2119?21310?2101310?21013102?19021310231310?100?1001310?100?1001310?190?17?201310?190?18?21310?190?18?21310?190?18?21310?190?1410?218?21410?515?214102?415?2141?6148?61244': 'F', '1236?2119?2131?2119?21310?119?01310?21013102?19021310231310231310?120?801310?1110?15?201310?1110?16?01310?110?0?16?2131?2110?0?16?2131?318?20?139?0?314?6139?202?702?141?010?2141?306?3143?402?4146?61294': 'P', '1505?2120?21300?120?01300?2118?201300?220130024130024130?230151?20152?0152?21469?2113?2111': 'l', '1242?2113?2137?2113?2137?2113?21370?1501370?15013702?1302137?30?1102137?160137?160137?4111?2137?0?112?2137?0?151?0?151?0?15137?0?15137?20?0?12137?1502138?150140?130152?2152?21173': 'n', '141?0152?21361?2113?21370?113?21370?113?0133?40?150131?3016?202130?3021130?4017?02130?70?150130?2150?113?01300?150?113?01300?2140?113?2130?413?2113?21443': 'f', '120?2119?2131?2119?21310?2101310?21013102?190213102?20013102?200131?03?7110?2131?50?817?2131?80?8140?80?7141?80?7141?70?6143?70?3145?50?3143?11140?13139?12139?12139?1317?2131?11110?2131?22013102?20013102313102?19021310?2101310?210131?2119?2111': 'M', '1296?2113?2137?2113?01370?113?01370?15013702?1302137017137?30?1102138?150137?4111?0137?0?112?2137?0?15102?151?0?151?0?15137?02?14137?2015138?1402140?130152?0152?2152?21119': 'n', '1242?2121?1300?121?1300?2119?21300?23130024130?3021130?130?10131?515?615?2130?419?416?130?0?111?0?16?130?0?111?0?13702?111?02137?0?111?0?137?0?317?30?137?202?100?2137?304?304?3138?309?3140?12146?51287': 'p', '1296?2113?2137?2113?2137?3111?201370?319?301370?417?30213702?414?601370?20?41?701370?16137?1312?2137?21?302?413?2137?212?912?2137?171370?1501370?513?7013702?315?4031370?318?3021370?2110?30137?2112?20137?2113?21227': 'x', '1359?6141?214?8139?413?302?4137?512?202?0?4137?512?80?137?512?80?137?413?314?0?137?215?215?0?1370?15?215?3137?3140?13?5137?70?9137?70?40?4137?2012?3138?150139?140152?2152?21281': 'a', '1203?0152?2149?40147?60144?70?0141?1102139?140136?90?313?2133?120?15?2131?12120?15?2131?9150?13803?5160?138?20?8130?138?50?80?15?2131?80?50?214?2134?702?20?412?2137?702?0?50139?80?0?30142?804145?702148?50150?30152?21119': 'A', '1354?9143?13140?309?3138?203?20?402?2138?20?40?60?2137?0?2130?14?20?137?3140?15?0?1370?150?15?0?137?2150?15?02137?0?140?15?0?137?0?410?15?0?137?20?40?14?20?138?205?14?4138?403?14?3141?614?21391': 'e', '1640?2145?413?2145?20?12?3145?02?6145?03?4146?7148?51549': ',', '1348?152?3115?2134?0?115?2133?20?115?0133?4115?0132?4116?0131?220131?0?1902131?022131?2102131?220152?0152?0152?0152?21389': '1', '1350?2121?1300?2120?1300?4118?13003?5114?213006?4112?01300?304?419?201300?603?514?30?130?213?503?80?2130?216?404?30?4140?504?3142?10134?215?40?51370?12?50?51390?502?414204?514502?41480?31500?152?21188': 'y', '1244?8143?13139?120?4136?5010?4135?50?70?6133?1802?132?30?417?50?2131?5113?5131?0?2115?20?131?3117?3131?3117?3131?2119?21310?110?217?0131?319?217?2131?319?217?2131?0?4160?10131?0?4160?10131?202?21609?2131?61602?9132?5160?9134?3170?9144?21128': 'G', '1512?2113?2137?2113?2137?2113?2130?4130?150130?4130?150130?02?1302?1302130?413?1502130?413?160131?214?160152?2152?21443': 'i', '1452?2119?2131?2119?21310?119?01310?21013102?19021310231310231310?2101310?2117?201310?119?0131?2119?21497': 'I', '1236?2119?2131?2119?21310?119?01310?21013102?19021310231310231310?2101310?2118?01310?119?0131?2119?0152?0152?0152?0152?0150?30147?502147?205147?71281': 'L', '1586?2145?314?2145?412?3145?9145?02?6145?0?6146?7148?51549': ',', '1460?514?5139?713?6137?40?412?6137?60?212?6137?70?213?4137?312?20?214?3137?214?20?15?0137?214?20?214?2137?512?02?21?4137?512?20?7137?512?30?20?3137?513?8139?414?7148?41338': 's', '1289?2120?21300?120?01300?2118?201300?220130024130024130?230137?519?20137?3112?2137?0?112?2137?0?15102?151?0?2150?0?15137?202?13138?2014138?1402141?120152?0152?21173': 'h', '1413?6141?214?302?3139?413?06?2137?202?12?20?50?137?0?312?0?60?1370?412?314?02137?215?2160?1370?15?215?0?1370?150?15?3137?3140?13?4138?0?50?9137?2012?3138?2014139?140151?20152?21281': 'a', '141?0152?21145?2121?1300?121?1300?2119?21300?23130024130?3021130?130?10131?515?615?2130?419?416?130?0?111?0?16?130?0?111?0?13702?111?02137?0?111?0?137?0?317?30?137?202?100?2137?304?304?3138?309?3140?12146?51287': 'p', '141?0152?21257?9143?13140?309?3138?203?02?20?02?2138?20?40?60?2137?0?2130?14?20?137?3140?15?0?1370?150?15?0?137?2150?15?02137?0?140?15?0?137?0?410?15?0?137?20?40?14?20?138?205?14?4138?403?14?3141?614?21391': 'e', '1200?2151?2152?21382?2113?2137?2113?2137?2113?2130?4130?150130?4130?150130?02?1302?1302130?413?1403130?413?160131?214?160152?2152?21443': 'i', '1296?21520?1520?21510?14139013?3138015?2137?1402?150?20?151?02151?0?137?2112?0?137?2112?0?1370?111?41370?1513802?1002?3137017137?1502137?160152?0152?21173': 'u', '1350?2113?2137?2113?21370?113?01370?15013702?1302137?2015137?40?0?802138?150137?4111?0137?0?112?0137?0?112?213702?3149?03?149?20?2149?51401': 'r', '1614?4150?0?614607?146?8146?41678': "'", '141?0152?21253?2121?1300?2120?1300?4118?13003?5114?213006?4112?01300?304?419?201300?603?514?30?130?213?503?80?2130?216?404?30?4140?504?3142?10134?215?40?51370?12?50?51390?502?414204?514502?41480?31500?152?21188': 'y', '1200?2151?2152?21105?2120?2130?2120?21300?2118?201300?2201300?220130024130?230130?230137?5110?2137?3112?2137?0?112?2137?0?151?0?2150?0?15137?17137?30?13138?1402139?140141?120152?2152?21173': 'h', '141?2152?21199?2121?130?3120?1300?4118?1300?6115?213003?7112?21300?402?519?201300?502?616?4130?24130?214?602?10130?216?15141?12132?215?13134?212?131370?131400?1114202?71450?5148?3151?21242': 'y', '126?2113?2137?2113?21370?113?01370?15013702?1302137017137?302?1002138?150137?4111?0137?0?112?2137?0?15102?151?0?2150?0?15137?202?13137?3014138?20?0?902137?160137?4111?0137?0?112?2137?0?15102?151?0?2150?0?15137?203?12137?3014138?1402141?120111': 'm', '141?2152?21145?2152?21520?21510?141390?15138013?4137?140?2137?150?150?20?151?0?137?2112?0?137?2112?0?137?2111?41370?161370?1613702?1002?3137?1403137?160137?160152?2152?21173': 'u', '1404?519?3137?518?4137?516?501370?415?40?01370?215?801370?15?40?401370?13?91?01370?12?40?412?01370?1014?01370?40?415?01370?716?2013703?415?401370?417?302137?418?5137?319?51335': 'z', '141?0152?21469?2113?2137?2113?21370?113?0130?4130?150130?02?1302?1302130?02?13017130?413?1502130?413?160152?0152?2152?21389': 'i', '141?2152?211415': ' ', '174?2119?2131?2119?21310?119?01310?21013102?19021310231310231310?90?1101310?2170?18?201310?180?19?0131?2180?19?21410?1520?1520?142?2180?19?2131?2180?19?21310?180?19?01310?90?11013102?80?100213102313102?19021310?2101310?119?0131?2119?2131?2119?21119': 'H', '141?2152?21145?2152?21520?21510?141390?15138013?4137?140?2137?150?150?20?151?0?137?2112?0?137?2112?0?137?2111?41370?161370?1613702?1002?3137?1403137?160137?160152?2152?21145?2113?2111': 'u', '141?0152?211415': ' ', '1242?2121?1300?121?1300?2119?21300?23130024130?3021130?130?10131?515?615?2130?419?416?130?0?111?0?16?130?0?111?0?13702?111?02137?0?111?0?137?0?317?30?137?202?100?2137?304?304?3138?309?3140?12146?51259?2113?2111': 'p', '1350?21520?21510?414903?514607?41430?305?51400?703?5138?214?503?3137?216?603148?402147?7137?216?91370?13?91400?502?414202?714503?31480?31500?152?21188': 'v', '1346?3115?3132?5112?302131?203?111?402131?02?3110?502131?0?419?20?302131?3111?51?021310?111?512?021310?19?613?02131?317?614?02131?0?213?40?216?02131?0?80?217?02131?207?317?202132?303?416?303133?718?204148?61389': '2', '1242?2152?21520?21510?141390?15138013?4137?140?2137?150?150?20?151?0?137?2112?0?137?2112?0?137?2111?41370?161370?1613702?1002?3137?1403137?160137?160152?2152?21145?2113?2111': 'u', '1242?2152?21520?21510?141390?15138013?4137?140?2137?150?150?20?151?0?137?2112?0?137?2112?0?137?2111?41370?161370?1613702?1002?3137?1403137?160137?160152?2152?21173': 'u', '1512?2121?130?2120?2124?2140?2117?30123?4130?210?123?02?13022?2123?02?13020?4123?413?221654': 'j', '1458?2152?2151?16136?30?011?3134?2017?213305?010?202?133?40?140?1370?112?201370?113?21370?113?2137?2113?21469?2113?2111': 't', '141?2152?21523?419?4137?419?4137?02?19?02?137?02?19?02?137?419?41659': ':', '11370?21520?1520?3130': ' ', '141?2152?21363?514?5139?713?6137?40?412?6137?60?212?6137?70?213?4137?312?20?214?3137?214?20?15?0137?214?20?214?2137?512?02?21?4137?512?20?7137?512?30?20?3137?513?8139?414?7148?41338': 's', '141?0152?21199?21520?1520?21510?14139013?3138015?2137?1402?150?20?151?02151?0?137?2112?0?137?2112?0?1370?111?41370?1513802?1002?3137017137?1502137?160152?0152?21173': 'u', '1344?614804?214802?414802?215002?119?13102?116?413102?114?40213102?111?50?313102?18?403?513102?15?502?513402?13?502?413702?60?514002?30?514304?51450?5148?31355': '7', '1236?2119?2131?2119?21310?119?01310?21013102?19021310231310231310?90?1101310?180?19?01310?180?19?01310?180?19?01310?180?19?01310?180?19?01310?180?19?01310?217?219?013102?414?218?2013105?111?402131?6111?05148?61281': 'E', '1354?9143?13140?309?3138?203?02?20?02?2138?20?40?60?2137?0?2130?14?20?137?3140?15?0?1370?150?15?0?137?2150?15?02137?0?140?15?0?137?0?410?15?0?137?20?40?14?20?138?205?14?4138?403?14?3141?614?21391': 'e', '1296?2121?130?3120?1300?4118?1300?6115?213003?7112?21300?402?519?201300?502?616?4130?24130?214?602?10130?216?15141?12132?215?13134?212?131370?131400?1114202?71450?5148?3151?21242': 'y', '11512': ' ', '1182?2152?21520?21510?191340?20133018?413202?140?20?31310?221310?2113?50?131?2117?20?131?2118?3131?2119?2152?2152?2131?2118?3131?2118?31310?2115?51310?221310?211320?201330?191340?152?21140': 'U', '1200?2151?2152?21229?6141?214?8139?413?302?4137?512?202?0?4137?512?80?137?512?80?137?413?314?0?137?215?215?0?1370?15?215?3137?3140?13?5137?70?9137?70?40?4137?2012?3138?150139?140152?2152?21281': 'a', '1297?9143?14138?3011?3136?2015?2134?202?1203?2133?0?517?402?2131?5113?20?2131?0?2115?20?131?0?117?02131?2118?0?1310?118?021310?118?02131?3117?0?131?0?2116?0?131?0?4113?02?131?203?112?20?2132?20?2112?4133?5112?31283': 'C', '126?2113?2137?2113?21370?1501370?15013702?1302137?30?1102137?160137?160137?4111?2137?0?112?2137?0?151?0?2150?0?15137?17137?30?13138?20?1102138?150137?160137?4111?2137?0?112?2137?0?151?0?2150?0?15137?17137?302?12138?1402139?140142?110111': 'm', '11478?2119?2111': ' ', '120?2119?2131?2119?21311?9143?13140?3010?2138?202?60?202?138?17137?0?219?20?137?3111?3137?2113?21370?113?0137?2113?2137?3111?3137?0?317?30?137?202?100?2138?2011?2140?307?3142?111284': 'o', '1452?2127?124?2126?21240?126?21240?28012402?2502?124028?2124026?31250?271260?21510?152?21518': 'J', '141?2152?21257?8144?12141?15139?15138?17137?17137?419?4137?3111?3137?2113?2137?2113?2137?3111?3137?517?5137?17137?17138?407?4140?13142?111284': 'o', '1359?6141?214?8139?413?302?4137?512?202?0?4137?512?80?137?512?80?137?413?314?0?137?215?215?0?1370?15?215?3137?3140?13?5137?70?9137?70?40?4137?2012?3138?150139?140152?2152?21253?2113?2111': 'a', '141?2152?21138?2120?21300?120?01300?2118?201300?220130024130021?3130?200?3137?615?6137?419?4137?0?111?0?137?0?111?0?13702?111?02137?0?111?0?137?0?317?30?137?202?100?2137?304?304?3138?309?3140?12146?51287': 'b', '1260?1520?21510?514804?614407?61410?504?61380?1?605?31370?15?604137?218?50?145?9142?11140?11141?10144?20?414704?5145?305?4143?504?5143?504?4144?603?147?403137?217?81370?14?111370?1314002?814403?41470?31500?152?2126': 'w', '1354?9143?13140?309?3138?203?02?20?02?2138?20?40?60?2137?0?2130?14?20?137?3140?15?0?1370?150?15?0?137?2150?15?02137?0?140?15?0?137?0?410?15?0?137?20?40?14?20?138?205?14?4138?403?14?3141?614?21363?2113?2111': 'e', '1236?6148?40214802?41480?31500?119?21310?119?21310?119?01310?2101310?20021310231310231310?2101310?118?201310?119?01310?119?21310?2118?21310?414902?4148?303148?61244': 'T', '1458?2152?2151?16136?30?011?3134?2017?213305?010?202?133?40?140?1370?112?201370?113?21370?113?2137?2113?21497': 't', '120?2119?2131?2119?21310?119?01310?21013102?190213102?180313102?20013104?5112?0131?204?5110?2131?504?5143?504?5143?504?5143?503?5143?504?3145?504146?40?3143?10141?10141?50?5141?10141?10110?2131?8113?013102?20013102313102313102?19021310?2101310?119?0111': 'M', '?46209?4303?20?402?420?40?60?400?50?70?450?70?380?60?70?450?702?380?50?70?390?50?70?400?40?70?4105?5103?452': 'r', '1257?0151?20149?40146?503144?50?30141?50?60138?503?313?0136?90?15?2133?10120?15?2131?10140?138?02?4170?13803?5160?138?05?5130?138?505?40?15?2134?504?20?214?2136?506?41?0139?504?50142?507145?504147?502150?30152?0152?2165': 'A', '1354?8144?12141?15139?15138?17137?17137?419?4137?3111?3137?2113?2137?2113?2137?3111?3137?517?5137?17137?17138?407?4140?13142?111256?2113?2111': 'o', '141?2152?21145?2121?1300?121?1300?2119?21300?23130024130?3021130?130?10131?515?615?2130?419?416?130?0?111?0?16?130?0?111?0?13702?111?02137?0?111?0?137?0?317?30?137?202?100?2137?304?304?3138?309?3140?12146?51287': 'p', '1460?514?5139?713?6137?40?412?6137?60?212?6137?70?213?4137?312?20?214?3137?214?20?15?0137?214?20?214?2137?512?02?21?4137?512?20?7137?512?30?20?3137?513?8139?414?7148?41310?2113?2111': 's', '1128?2119?2131?2119?21310?119?01310?21013102?19021310231310231310?2101310?119?01310?119?01310?119?01310?119?0131?2118?3131?0?117?0?131?0?2115?20?131?5113?20?2131?20?419?40?2132?203?1103?2134?205?505?2136?3011?3138?505?5141?111233': 'D', '1235?2120?21300?120?01300?2118?201300?220130024130021?3130?200?3137?615?6137?419?4137?0?111?0?137?0?111?0?13702?111?02137?0?111?0?137?0?317?30?137?202?100?2137?304?304?3138?309?3140?12146?51287': 'b', '141?0152?21311?9143?13140?3010?2138?202?60?202?138?17137?0?219?20?137?3111?3137?2113?21370?113?0137?2113?2137?3111?3137?0?317?30?137?202?100?2138?2011?2140?307?3142?111284': 'o', '1236?2152?31510?414902?414803?5113?21310?30?5111?21310?50?519?21310?60?517?20131?212?402?120131?214?160139?4011131?217?130131?215?150131?213?817?201310?1119?21310?9111?21310?7113?213102?41480?4149?3151?21194': 'Y', '1458?2113?21370?113?21370?113?0133?40?150131?3016?202130?3021130?4017?02130?70?150130?2150?113?01300?150?113?01300?2140?113?2130?413?2113?21443': 'f', '126?2113?2137?2113?21370?1501370?15013702?1302137?30?1102137?160137?160137?4111?2137?0?112?2137?0?151?0?2150?0?15137?17137?30?13138?20?1102138?150137?160137?4111?2137?0?112?2137?0?151?0?2150?0?15137?17137?302?12138?1402139?140137?213?12111': 'm', '1296?2152?31510?41490?714603?81430?40?71410?70?0?5138?90?20?4137?214?502?4137?217?602147?7137?216?9137?213?121370?131400?1014302?71450?51480?3150?21242': 'v', '120?2119?2131?2119?21262?6141?214?8139?413?302?4137?512?202?0?4137?512?80?137?512?80?137?413?314?0?137?215?215?0?1370?15?215?3137?3140?13?5137?70?9137?70?40?4137?2012?3138?150139?140152?2152?21281': 'a', '120?2119?2131?2119?21257?8144?12141?15139?15138?17137?17137?419?4137?3111?3137?2113?2137?2113?2137?3111?3137?517?5137?17137?17138?407?4140?13142?111284': 'o', '1128?2119?2131?2119?2131?2119?21310?2101310?21013102?1902131?03?180131?202?180131?40?4112?0132?40?5110?2133?50?419?2135?402?4146?40?5145?50?4146?40?5135?218?50?4134?2110?40?51320?111?50?41310?1702?31310?1704?1310?221310?221310?2151?2152?2186': 'N', '120?2119?2131?2119?21145?2152?21520?21510?141390?15138013?4137?140?2137?150?150?20?151?0?137?2112?0?137?2112?0?137?2111?41370?161370?1613702?1002?3137?1403137?160137?160152?2152?21173': 'u', '1512?2113?2137?2113?2137?2113?2130?4130?150130?4130?150130?02?1302?1302130?413?1403130?413?160131?214?160152?2152?21415?2113?2111': 'i', '1300?9143?30?50?3140?309?3138?203?0?30?03?2137?02?1102?137?0?219?20?137?0?111?0?13702?111?02137?0?111?0?130?215?0?111?0?1300?15?419?41300?2213102?80?13130024130?2202130?230152?0152?0152?21227': 'd', '1348?7145?403?416?3133?307?216?0?2131?202?203?02?215?20?131?0?100?16?3131?0?216?20?17?0131?318?0217?01310?110?216?3131?318?316?0?131?0?217?0?14?30?131?0?414?41?50?2131?202?1402?2133?3014?3135?4010?4138?60?7143?71344': '9', '1189?9142?15138?3011?3136?2015?2134?202?1302?2133?0?517?50?132?5113?5131?0?2115?20?131?3117?3131?2119?21310?119?01310?119?0131?2119?2131?0?117?0?131?0?2115?20?131?20?2113?20?2132?02?515?502?133?203?1103?2134?3013?3136?3010?4139?60?6144?71181': 'O', '1347?518?5135?302?316?20?3133?206?215?302?2131?20?403?214?50?131?0?702?17?20?131?314?202?217?3131?216?03?18?01310?17?02?217?01310?17?202?17?2131?317?02?215?3131?0?315?202?213?20?131?20?315?02?9131?203?15?204?02?2133?516?304?3135?218?8148?31340': 'S', '1358?6136?714?302?4133?303?312?206?2132?207?402?50?2131?0?602?612?30?131?0?213?203?216?3131?315?202?18?21310?17?02?18?01310?17?02?217?0131?315?202?216?3131?0?213?50?215?0?131?1202?212?30?131?206?21?202?50?2132?40?313?206?2134?615?302?3147?61338': '8', '1633?4150?02?150?02?150?02?150?41659': '.', '141?2152?21415?2113?2137?2113?2137?2113?2130?4130?150130?4130?150130?02?1302?1302130?413?1403130?413?160131?214?160152?2152?21443': 'i', '141?2152?21257?9143?13140?309?3138?203?02?20?02?2138?20?40?60?2137?0?2130?14?20?137?3140?15?0?1370?150?15?0?137?2150?15?02137?0?140?15?0?137?0?410?15?0?137?20?40?14?20?138?205?14?4138?403?14?3141?614?21391': 'e', '1236?2119?2131?2119?2131?2119?21310?2101310?21013102?19021310231310?90?1101310?90?1101310?180?19?01310?180?19?0131?217?0?19?0131?316?0?19?2131?414?517?3131?0?1215?4131?210?131?305?120?2132?91?306?3133?713?30?6135?514?9147?51177': 'B', '126?2113?2137?2113?01370?113?01370?15013702?1302137017137?302?1002138?150137?4111?0137?0?112?2137?0?15102?151?0?2150?0?15137?202?13137?3014138?20?0?902137?160137?4111?0137?0?112?2137?0?15102?151?0?2150?0?15137?203?12137?3014138?1402141?120111': 'm', '1300?9143?30?50?3140?309?3138?203?0?30?03?2137?02?1102?137?0?219?20?137?0?111?0?13702?111?02137?0?111?0?16?130?0?111?0?16?130?419?416?131?23130?30?90?90130?02313003?2001300?231300?121?1300?121?130?2121?1220': 'q', '1354?8144?12141?15139?15138?17137?17137?419?4137?3111?3137?2113?2137?2113?2137?3111?3137?517?5137?17137?17138?407?4140?13142?111284': 'o', '11484?2113?2111': ' ', '141?2152?21257?9143?13140?309?3138?203?02?20?02?2138?20?40?60?2137?0?2130?14?20?137?3140?15?0?1370?150?15?0?137?2150?15?02137?0?140?15?0?137?0?410?15?0?137?20?40?14?20?138?205?14?4138?403?14?3141?614?21363?2113?2111': 'e', '1236?2119?2131?2119?2131X?119?X131X?21X131X2?19X2131X23131X23131X?12X?8X131X?111X?15?2X131X?111X?16?X131X?110?X?16?2131?2110?X?16?2131?318?2X?139?X?314?6139?2X?8X2?141?X10?2141?3X6?3143?10146?61294': 'P', '1290?2119?2131?2119?21310?119?01310?21013102?19021310231310231310?90?1101310?180?19?01310?180?19?01310?180?19?0131?217?0?19?0131?316?0?19?2131?0?214?517?3131?0?70?0?215?20?131?207?30?702?132?205?21?208?2132?91?306?2135?514?9147?61176': 'B', '141?0152?21316?6141?214?302?3139?413?06?2137?202?12?20?50?137?0?312?0?60?1370?412?314?02137?215?2160?1370?15?215?0?1370?150?15?3137?3140?13?4138?0?50?9137?2012?3138?2014139?140151?20152?21281': 'a', '12003?514605?614309?61390?506?61360?12?605?6133?215?606?4131?219?605?145?603145?60?2141?13138?60?6137?60?6138?50?6142?203?414505?6143?305?6141?605?6140?605?6141?605?4142?704?146?503145?502?2131?218?60?61310?14?70?61340?80?61380?402?614103?61450?5128': 'W', '141?2152?21145?2113?2137?2113?2137?2113?21370?1501370?15013702?1302137?30?1102137?160137?160137?4111?2137?0?112?2137?0?151?0?151?0?15137?0?15137?20?0?12137?1502138?150140?130152?2152?21173': 'n', '1200?2151?2152?21224?8144?12141?15139?15138?17137?17137?419?4137?3111?3137?2113?2137?2113?2137?3111?3137?517?5137?17137?17138?407?4140?13142?111284': 'o', '1512?2113?2137?2113?2137?2113?2130?4130?150130?4130?150130?02?1302?1302130?413?1403130?413?160131?214?160152?2152?21443': 'i', '1313?6135?319?8132?713?31?06?131?205?21?120130?202?302?40?413?20130?0?70?402?15?2130?315?20?1?02?16?130?217?0130217?1300?17?0130217?130?315?3130217?130?0?70?1302?15?2130?02?50?213?0?15?0129?405?214?0?8129?0?40?414?02?50?129?0?12?416?304?3129?0?113?8130?3115?4133?1297': 'g', '141?2152?21536?4150?02?150?02?150?02?150?41659': '.', '1343?2120?21300?120?01300?2118?201300?220130024130024130?230144?413?20143?20?15?2142?202?313?2137?21?502?31410?803?31390?20?212?303?213803?214?303?213702?217?302?1370?219?30?1370?112?3137?2113?0152?21173': 'k', '1235?2120?2130?2120?21300?2118?201300?2201300?220130024130?230130?230137?5110?2137?3112?2137?0?112?2137?0?151?0?2150?0?15137?17137?30?13138?1402139?140141?120152?2152?21173': 'h', '1514?514?5139?30?313?02?3137?205?212?40?137?602?14?4137?312?20?214?3137?214?02?15?01370?14?20?214?0137?314?02?13?3137?512?02?21?4137?02?212?202?6137?513?204?3138?414?30?3148?41338': 's', '1362?4136?816?4132?70?20?16?20?213104?60?16?30?13102?512?219?0213102?16?2110?213102?160?110?013102?160?110?013102?16?0?18?313102?16?0?216?20?13102?16?02?90?13102?314?203?502?213103?215?208?2132?516?204?4145?81392': '5', '1566?2113?2137?2113?21370?113?0130?4130?150130?02?1302?1302130?02?13017130?413?1502130?413?160152?0152?2152?21389': 'i',"1182?2119?2131?2119?2131?2119?21310?2101310?21013102?19021310231310?2101310?2101310?216?516?20131?216?617?2131?215?40?316?2137?502?4142?702?4136?21?61?40?5134?813?402?41330?616?40?41320?518?402?313102?3110?402?21310?3113?40?1310?2115?5131?2118?0?131?2119?21119":"K"}

special_cases = {"?":[0xbf,True],",":[0xbc,False],".": [0xbe,False],"\"":[0xde,True]," ":[0x20,False],"$":[0x34,True],"'":[0xde,False],"ENTER":[0xd,False]}
def mode(arr):
    m = max([arr.count(a) for a in arr])
    return [x for x in arr if arr.count(x) == m][0] if m>1 else None
def positionOverCookie():
    mousePos(CookieCritical.c_cookie())
def getPixelatmouse():
    im = ImageGrab.grab()
    return im.getpixel(getcords())
def hitKey(char,t):
    shiftit = False
    if char in string.ascii_lowercase:
        KEY = 0x41 + ord(char) - 97
    elif char in string.ascii_uppercase:
        KEY = 0x41 + ord(char) - 65
        shiftit = True
    elif char in string.digits:
        KEY = 0x30 + ord(char) - ord("0")
    elif char in special_cases:
        shiftit = special_cases[char][1]
        KEY = special_cases[char][0]
    else:
        print "Oh Noes! No Key Assigned for <%s> Char."%(char)
        
    if shiftit:
        win32api.keybd_event(0xa0,0,0,0)
    win32api.keybd_event(KEY,0,0,0) # holds the "F" key down
    time.sleep(t) # waits 2 seconds
    win32api.keybd_event(KEY,0,win32con.KEYEVENTF_KEYUP,0) #
    if shiftit:
        win32api.keybd_event(0xa0,0,win32con.KEYEVENTF_KEYUP,0)
def mousePos(cord):
    win32api.SetCursorPos(cord)

def leftClick():
    win32api.mouse_event(win32con.MOUSEEVENTF_LEFTDOWN,0,0)
    time.sleep(.1)
    win32api.mouse_event(win32con.MOUSEEVENTF_LEFTUP,0,0)
 
def getcords():
    return win32api.GetCursorPos()

HIGHLIGHTING = (172,234,160)
INCORRECT_HIGHLIGHTING = (234, 170, 160)

UNINIT_TEXT = (123,123,123)
ACTIVE_TEXT = (36, 43, 35)
ACTIVE_TEXT2 = (46, 46, 46)
ACTIVE_TEXT3 = (73, 86, 71) # Account for image blending
ACTIVE_TEXT4 = (59,65,57)
def scanletterboi():
    im = ImageGrab.grab()
    hashstring = ""
    weirdletters = set([])
    for x in range(minx,maxx):
        for y in range(miny,maxy):
            if im.getpixel((x,y)) in [HIGHLIGHTING,INCORRECT_HIGHLIGHTING]:
                hashstring += "1"
            elif im.getpixel((x,y)) == UNINIT_TEXT:
                hashstring += "X"
            elif im.getpixel((x,y)) in [ACTIVE_TEXT,ACTIVE_TEXT2,ACTIVE_TEXT3,ACTIVE_TEXT4]:
                hashstring += "0"
            else:
                hashstring += "?"
                weirdletters.add(im.getpixel((x,y)))
    #print weirdletters
    #print hashstring.count("0")
    return compress(hashstring)
def f(x):
    im = ImageGrab.grab()
    for i in range(100,700):
        if im.getpixel((x,i)) == HIGHLIGHTING:
            return i
def r(x):
    im = ImageGrab.grab()
    hit = False
    for i in range(100,700):
        #mousePos((x,i))
        if im.getpixel((x,i)) == HIGHLIGHTING:
            hit = True
        elif hit:
            return i
def compress(string):

    res = ""

    count = 1

    #Add in first character
    res += string[0]

    #Iterate through loop, skipping last one
    for i in range(len(string)-1):
        if(string[i] == string[i+1]):
            count+=1
        else:
            if(count > 1):
                #Ignore if no repeats
                res += str(count)
            res += string[i+1]
            count = 1
    #print last one
    if(count > 1):
        res += str(count)
    return res
def setLetter():
    v = infer(scanletterboi())
    if v == None:
        v = raw_input("Unconfident: ")
    hashk[scanletterboi()] = v
    print "Letter Set!"
def pcentagree(s1,s2):
    agree = 0
    for i in range(0,min(len(s1),len(s2))):
        if s1[i] == s2[i]:
            agree += 1
    return agree/float(max(len(s1),len(s2)))
def infer(st):
    if st == "11512":
        return " "
    keys = []
    for i in hashk.keys():
        keys.append([hashk[i],pcentagree(i,st)])
    keys.sort(key = lambda a:a[1],reverse = True)
    if keys[0][1] > 0.9:
        print "[INFER]: %s"%(keys[0][0])
        return keys[0][0]
    return None
print "Intializing the Calibrations"
im = ImageGrab.grab()
while im.getpixel((590,32)) == (173,195,218):
    print "Please Resume focus"
    im = ImageGrab.grab()
x = 200
while f(x) == None:
    x += 1
maxy = r(x)
miny = f(x)
minx = x
while f(x) != None:
    x += 1
maxx = x
unfindable_charecter = "?1512"
print "Calibration Done!"
prevchar = "*"
letter = 0
while True:
    letter += 1
    res = scanletterboi()
    try:
        char = hashk[res]
        if char != prevchar:
            #print "Ooh thats a <%s>! (%s)"%(char,res)
            if letter % 100 < 2:
                hitKey("r",0.001) # mess with the accuracy a bit
            hitKey(char,0.001)
            prevchar = char
        else:
            #time.sleep(0.005)
            prevchar = "*"
    except:
        if scanletterboi() == res:
            print "New Sequence (%s) Tell me what letter that is"%(res)
            if res == "?1512":
                print "End of Race? Hit Enter to recalibrate"
                time.sleep(3)
                hitKey("ENTER",0.001)
                time.sleep(5)
                print "Starting Calibration"
                x = 200
                while f(x) == None:
                    x += 1
                maxy = r(x)
                miny = f(x)
                minx = x
                while f(x) != None:
                    x += 1
                maxx = x
            setLetter()
            im = ImageGrab.grab()
            while im.getpixel((590,32)) == (173,195,218):
                print "Please Resume focus"
                im = ImageGrab.grab()
            
